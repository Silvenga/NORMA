<?xml version="1.0" encoding="utf-8"?>
<!--
	Neumont Object-Role Modeling Architect for Visual Studio

	Copyright Â© Neumont University. All rights reserved.

	The use and distribution terms for this software are covered by the
	Common Public License 1.0 (http://opensource.org/licenses/cpl) which
	can be found in the file CPL.txt at the root of this distribution.
	By using this software in any fashion, you are agreeing to be bound by
	the terms of this license.

	You must not remove this notice, or any other, from this software.
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2003/01/wi">
	<?include Config.wxi?>
	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">

			<Directory Id="$(var.ProgramFilesFolder)">
				<Directory Id="$(var.DefaultCompanyDir)" Name="$(var.DefaultCompanyDir)">
					<Directory Id="$(var.DefaultShortProductDir)" Name="$(var.DefaultShortProductDir)" LongName="$(var.DefaultProductDir)">

						<Component Id="LicenseFilesComponent" Guid="8D623CBC-D6BC-40DA-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="CPL.txt" Name="CPL.txt" src="..\CPL.txt"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
						</Component>

						<Directory Id="BINDIR" Name="bin">

							<!-- Executables and PDBs go here -->
							<Component Id="NORMAVSPackageComponent" Guid="568F224E-9C2F-4A85-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
								<File Id="Neumont.Tools.ORM.dll" Name="ORM.dll" LongName="Neumont.Tools.ORM.dll" src="..\ORMModel\bin\$(var.BuildConfiguration)\Neumont.Tools.ORM.dll"
									DefaultVersion="$(var.ProductVersion)" DefaultLanguage="0" KeyPath="yes" Vital="yes" Assembly=".net" AssemblyManifest="Neumont.Tools.ORM.dll" ProcessorArchitecture="msil" AssemblyApplication="Neumont.Tools.ORM.dll"/>
								<File Id="Neumont.Tools.ORM.pdb" Name="ORM.pdb" LongName="Neumont.Tools.ORM.pdb" src="..\ORMModel\bin\$(var.BuildConfiguration)\Neumont.Tools.ORM.pdb"
									DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
								<File Id="Neumont.Tools.ORM.xml" Name="ORM.xml" LongName="Neumont.Tools.ORM.xml" src="..\ORMModel\bin\$(var.BuildConfiguration)\Neumont.Tools.ORM.xml"
									DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
								<?include NORMAVSPackageRegistry.wxi?>
								<ProgId Id="ormfile" Description="$(loc.ORMFileDescription)" Icon="[#Neumont.Tools.ORM.dll]" IconIndex="0">
									<Extension Id="orm" ContentType="application/orm+xml">
										<MIME ContentType="application/orm+xml" Default="yes"/>
										<Verb Id="Open" Sequence="0" Command="$(loc.ORMFileOpenCommand)" Target="[VSENVIRONMENTPATH]" Argument="$(var.RootSuffixCmd)/dde &quot;%1&quot;"/>
									</Extension>
								</ProgId>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKCR" Key="ormfile\shell\open\ddeexec">
									<Registry Value="Open(&quot;%1&quot;)" Type="string"/>
									<Registry Key="application" Value="VisualStudio.8.0" Type="string"/>
									<Registry Key="topic" Value="system" Type="string"/>
								</Registry>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="SOFTWARE\Microsoft\.NETFramework\v2.0.50727\AssemblyFoldersEx\NORMAVS">
									<Registry Type="string" Value="[BINDIR]"/>
								</Registry>
							</Component>

							<Directory Id="LCIDDIR" Name="$(var.DefaultLCID)">
								<Component Id="NORMAVSPackageSatelliteComponent_$(var.DefaultLCID)" Guid="1193038A-BC95-$(var.DefaultLCID)-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
									<File Id="Neumont.Tools.ORMUI.dll" Name="ORMUI.dll" LongName="Neumont.Tools.ORMUI.dll" src="..\ORMModelSatDll\bin\Neumont.Tools.ORMUI.dll"
										DefaultVersion="$(var.ProductVersion)" KeyPath="yes"/>
								</Component>
							</Directory>

							<Component Id="ORMCustomToolComponent" Guid="9B2F677A-1D14-4E9E-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
								<File Id="Neumont.Tools.ORM.ORMCustomTool.dll" Name="ORMCstTl.dll" LongName="Neumont.Tools.ORM.ORMCustomTool.dll" src="..\XML\ORMCustomTool\bin\Neumont.Tools.ORM.ORMCustomTool.dll"
									DefaultVersion="$(var.ProductVersion)" DefaultLanguage="0" KeyPath="yes" Assembly=".net" AssemblyManifest="Neumont.Tools.ORM.ORMCustomTool.dll" AssemblyApplication="Neumont.Tools.ORM.ORMCustomTool.dll" ProcessorArchitecture="msil"/>
								<File Id="Neumont.Tools.ORM.ORMCustomTool.pdb" Name="ORMCstTl.pdb" LongName="Neumont.Tools.ORM.ORMCustomTool.pdb" src="..\XML\ORMCustomTool\bin\Neumont.Tools.ORM.ORMCustomTool.pdb"
									DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.ORMCustomTool.dll"/>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKCR" Key="CLSID\{$(var.ORMCustomToolGuid)}">
									<Registry Type="string" Value="Neumont.Tools.ORM.ORMCustomTool.ORMCustomTool, $(var.ORMCustomToolAssemblyName)"/>
									<Registry Action="createKey" Key="InprocServer32">
										<Registry Type="string" Value="[$(var.SystemFolder)]mscoree.dll"/>
										<Registry Type="string" Name="ThreadingModel" Value="Both"/>
										<Registry Type="string" Name="Class" Value="Neumont.Tools.ORM.ORMCustomTool.ORMCustomTool"/>
										<Registry Type="string" Name="Assembly" Value="$(var.ORMCustomToolAssemblyName)"/>
										<Registry Type="string" Name="CodeBase" Value="[#Neumont.Tools.ORM.ORMCustomTool.dll]"/>
									</Registry>
								</Registry>
							</Component>
							<Component Id="ORMCustomToolVBasicComponent" Guid="0B8DF8D8-7418-47F3-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
								<CreateFolder/>
								<Condition>VBASICPACKAGEGUID OR Installed</Condition>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.VSRegRoot)\Generators\[VBASICPACKAGEGUID]\ORMCustomTool">
									<Registry Type="string" Value="$(loc.ORMCustomToolDescription)"/>
									<Registry Type="string" Name="CLSID" Value="{$(var.ORMCustomToolGuid)}"/>
								</Registry>
							</Component>
							<Component Id="ORMCustomToolVCSharpComponent" Guid="E42EF6E9-2EBD-4AA7-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
								<CreateFolder/>
								<Condition>VCSHARPPACKAGEGUID OR Installed</Condition>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.VSRegRoot)\Generators\[VCSHARPPACKAGEGUID]\ORMCustomTool">
									<Registry Type="string" Value="$(loc.ORMCustomToolDescription)"/>
									<Registry Type="string" Name="CLSID" Value="{$(var.ORMCustomToolGuid)}"/>
								</Registry>
							</Component>
							<Component Id="ORMCustomToolVJSharpComponent" Guid="5E506A17-A87F-4B81-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
								<CreateFolder/>
								<Condition>VJSHARPPACKAGEGUID OR Installed</Condition>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.VSRegRoot)\Generators\[VJSHARPPACKAGEGUID]\ORMCustomTool">
									<Registry Type="string" Value="$(loc.ORMCustomToolDescription)"/>
									<Registry Type="string" Name="CLSID" Value="{$(var.ORMCustomToolGuid)}"/>
								</Registry>
							</Component>
						</Directory>

						<Directory Id="PROJECTITEMSDIR" Name="PrjItms" LongName="ORMProjectItems">
							<Component Id="NORMAVSProjectItemsComponent" Guid="6AA85376-6754-4D7B-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
								<File Id="ORMProjectItems.vsdir" Name="PrjItems.vdr" LongName="ORMProjectItems.vsdir" src="..\ORMModel\Shell\ProjectItems\ORMProjectItems.vsdir"
									DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
								<File Id="ORMModel.orm" Name="ORMModel.orm" src="..\ORMModel\Shell\ProjectItems\ORMModel.orm"
									DefaultLanguage="0" CompanionFile="ORMProjectItems.vsdir"/>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.VSRegRoot)\Projects\{$(var.VSGeneralProjectGuid)}\AddItemTemplates\TemplateDirs\{$(var.NORMAVSPackageGuid)}">
									<Registry Key="/1" Type="string" Value="#107"/>
									<Registry Key="/1" Type="string" Name="TemplatesDir" Value="[PROJECTITEMSDIR]"/>
									<Registry Key="/1" Type="integer" Name="SortPriority" Value="50"/>
								</Registry>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.VSRegRoot)\Projects\{$(var.VSMiscProjectGuid)}\AddItemTemplates\TemplateDirs\{$(var.NORMAVSPackageGuid)}">
									<Registry Key="/1" Type="string" Value="#107"/>
									<Registry Key="/1" Type="string" Name="TemplatesDir" Value="[PROJECTITEMSDIR]"/>
									<Registry Key="/1" Type="integer" Name="SortPriority" Value="50"/>
								</Registry>
								<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.VSRegRoot)\Projects\{$(var.VSSolutionItemsProjectGuid)}\AddItemTemplates\TemplateDirs\{$(var.NORMAVSPackageGuid)}">
									<Registry Key="/1" Type="string" Value="#107"/>
									<Registry Key="/1" Type="string" Name="TemplatesDir" Value="[PROJECTITEMSDIR]"/>
									<Registry Key="/1" Type="integer" Name="SortPriority" Value="50"/>
								</Registry>
							</Component>
						</Directory>

						<Directory Id="Help" Name="Help">
							<!-- Help files go here -->
							<Component Id="NORMAVSHelpComponent" Guid="31ED0AEA-D66C-4AD0-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
								<File Id="Creating_ORM_Schemas.doc" Name="CrORMSch.doc" LongName="Creating ORM Schemas.doc" src="..\Documentation\Creating ORM Schemas.doc"
										DefaultLanguage="$(var.DefaultLCID)" CompanionFile="Neumont.Tools.ORM.dll"/>
							</Component>
						</Directory>

						<Directory Id="Xml" Name="Xml">
							<Directory Id="Schemas" Name="Schemas">
								<!-- XSDs specific to NORMA for VS go here. Anything potentially applicable to other programs should go under ORMCOMMONSCHEMASDIR or DILCOMMONSCHEMASDIR. -->
								<Component Id="NORMAVSSchemasLocalCatalogComponent" Guid="BCC47EB8-CEFC-421F-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
									<File Id="NORMAcatalog.xml" Name="catalog.xml" src="..\ORMModel\Shell\catalog.xml"
										DefaultLanguage="0" CompanionFile="NORMASchemaCatalog.xml"/>
								</Component>
								<Component Id="NORMAVSSettingsSchemaComponent" Guid="B2DEF872-436C-4BED-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
									<File Id="ORMDesignerSettings.xsd" Name="DsgnrStg.xsd" LongName="ORMDesignerSettings.xsd" src="..\ORMModel\Shell\ORMDesignerSettings.xsd"
										DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
								</Component>
							</Directory>
							<Directory Id="Transforms" Name="Trnsfrms" LongName="Transforms">
								<!-- XSLTs specific to NORMA for VS go here. Anything potentially applicable to other programs should go under ORMCOMMONTRANSFORMSDIR or DILCOMMONTRANSFORMSDIR. -->
								<Directory Id="Converters" Name="Cnvrtrs" LongName="Converters">
									<Component Id="NORMAVSConvertersComponent" Guid="588FBA11-2175-4084-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
										<File Id="CoreModelImport.xslt" Name="CrMdlImp.xsl" LongName="CoreModelImport.xslt" src="..\ORMModel\Shell\Converters\CoreModelImport.xslt"
											DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
										<File Id="CoreUpgradeTo2006_01.xslt" Name="CUTo0601.xsl" LongName="CoreUpgradeTo2006-01.xslt" src="..\ORMModel\Shell\Converters\CoreUpgradeTo2006-01.xslt"
											DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
										<File Id="RootUpgradeTo2006_01.xslt" Name="RUTo0601.xsl" LongName="RootUpgradeTo2006-01.xslt" src="..\ORMModel\Shell\Converters\RootUpgradeTo2006-01.xslt"
											DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
										<File Id="VisioToCoreModelImport.xslt" Name="VsCrMdl.xsl" LongName="VisioToCoreModelImport.xslt" src="..\ORMModel\Shell\Converters\VisioToCoreModelImport.xslt"
											DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
										<Registry Root="HKLM" Key="$(var.NORMAVSRegRoot)" Type="string" Name="ConvertersDir" Value="[Converters]"/>
									</Component>
								</Directory>
							</Directory>
						</Directory>

						<Component Id="NORMAVSSettingsComponent" Guid="956063F7-13D9-4083-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
							<File Id="ORMDesignerSettings.xml" Name="DsgnrStg.xml" LongName="ORMDesignerSettings.xml" src="..\ORMModel\Shell\ORMDesignerSettings.xml"
								DefaultLanguage="0" KeyPath="yes"/>
							<Registry Root="HKLM" Key="$(var.NORMAVSRegRoot)" Type="string" Name="SettingsPath" Value="[#ORMDesignerSettings.xml]"/>
						</Component>
						
					</Directory>
				</Directory>
			</Directory>
			
			<Directory Id="$(var.CommonFilesFolder)">
				
				<Directory Id="ORMCOMMONFILESDIR" Name="ORM">
					<Directory Id="ORMCOMMONSCHEMASDIR" Name="Schemas">
						<Component Id="ORMSchemasLocalCatalogComponent" Guid="CA6158D1-A87F-413B-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="ORMcatalog.xml" Name="catalog.xml" src="..\catalog.xml"
								DefaultLanguage="0" CompanionFile="ORMSchemaCatalog.xml"/>
						</Component>
						<Component Id="ORMSchemasComponent" Guid="55B51F55-EB34-4AC4-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="ORM2Core.xsd" Name="ORM2Core.xsd" src="..\ORMModel\ObjectModel\ORM2Core.xsd"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<File Id="ORM2Diagram.xsd" Name="ORM2Diag.xsd" LongName="ORM2Diagram.xsd" src="..\ORMModel\ShapeModel\ORM2Diagram.xsd"
								DefaultLanguage="0" CompanionFile="ORM2Core.xsd"/>
							<File Id="ORM2Root.xsd" Name="ORM2Root.xsd" src="..\ORMModel\Shell\ORM2Root.xsd"
								DefaultLanguage="0" CompanionFile="ORM2Core.xsd"/>
						</Component>
						<Component Id="OIALSchemasComponent" Guid="D5543428-F53D-42D3-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="OIAL.xsd" Name="OIAL.xsd" src="..\XML\OIAL\OIAL.xsd"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<File Id="ORMDataTypes.xsd" Name="ORMDT.xsd" LongName="ORMDataTypes.xsd" src="..\XML\OIAL\ORMDataTypes.xsd"
								DefaultLanguage="0" CompanionFile="OIAL.xsd"/>
							<File Id="ORMDataTypes_Temporal.xsd" Name="ORMDT-T.xsd" LongName="ORMDataTypes-Temporal.xsd" src="..\XML\OIAL\ORMDataTypes-Temporal.xsd"
								DefaultLanguage="0" CompanionFile="OIAL.xsd"/>
						</Component>
					</Directory>
					<Directory Id="ORMCOMMONTRANSFORMSDIR" Name="Trnsfrms" LongName="Transforms">
						<Component Id="ORMTransformsComponent" Guid="92A82A59-CC06-4850-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="CoRefORM.xslt" Name="CoRefORM.xsl" LongName="CoRefORM.xslt" src="..\XML\OIAL\CoRefORM.xslt"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\CoRefORM">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="CoRefORM"/>
								<Registry Type="string" Name="DisplayName" Value="ORM Co-Referencer"/>
								<Registry Type="string" Name="DisplayDescription" Value="Co-references (binarizes) an ORM file."/>
								<Registry Type="string" Name="FileExtension" Value=".orm"/>
								<Registry Type="string" Name="SourceInputFormat" Value="ORM"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="ORM"/>
								<Registry Type="string" Name="TransformUri" Value="[#CoRefORM.xslt]"/>
							</Registry>
						</Component>
						<Component Id="OIALTransformsComponent" Guid="165ED455-31BE-4E30-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="ORMtoOIAL.xslt" Name="ORM2OIAL.xsl" LongName="ORMtoOIAL.xslt" src="..\XML\OIAL\ORMtoOIAL.xslt"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\ORMtoOIAL">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="ORMtoOIAL"/>
								<Registry Type="string" Name="DisplayName" Value="ORM to OIAL"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms an ORM file to OIAL."/>
								<Registry Type="string" Name="FileExtension" Value=".OIAL.xml"/>
								<Registry Type="string" Name="SourceInputFormat" Value="ORM"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="OIAL"/>
								<Registry Type="string" Name="TransformUri" Value="[#ORMtoOIAL.xslt]"/>
							</Registry>
						</Component>
						<Component Id="ORMClassModelTransformsComponent" Guid="82A94F1B-CC68-4924-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<CreateFolder/>
							<!-- UNDONE: This is being omitted until it uses OIAL and has stabalized. -->
						</Component>
						<Component Id="ORMXmlSchemaTransformsComponent" Guid="E9166531-A29B-49B6-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="OIALtoXSD.xslt" Name="OIAL2XSD.xsl" LongName="OIALtoXSD.xslt" src="..\XML\OIALtoXSD\OIALtoXSD.xslt"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\OIALtoXSD">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="OIALtoXSD"/>
								<Registry Type="string" Name="DisplayName" Value="OIAL to XSD"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms an OIAL file to XML Schema."/>
								<Registry Type="string" Name="FileExtension" Value=".xsd"/>
								<Registry Type="string" Name="SourceInputFormat" Value="OIAL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="XSD"/>
								<Registry Type="string" Name="TransformUri" Value="[#OIALtoXSD.xslt]"/>
							</Registry>
						</Component>
						<Component Id="ORMRelationalSchemaTransformsComponent" Guid="2A455908-5BB2-48A3-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="OIALtoDCIL.xslt" Name="OIL2DCIL.xsl" LongName="OIALtoDCIL.xslt" src="..\XML\OIALtoDCIL\OIALtoDCIL.xslt"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\OIALtoDCIL">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="OIALtoDCIL"/>
								<Registry Type="string" Name="DisplayName" Value="OIAL to DCIL"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms an OIAL file to DCIL."/>
								<Registry Type="string" Name="FileExtension" Value=".DCIL.xml"/>
								<Registry Type="string" Name="SourceInputFormat" Value="OIAL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="DCIL"/>
								<Registry Type="string" Name="TransformUri" Value="[#OIALtoDCIL.xslt]"/>
							</Registry>
						</Component>
					</Directory>
				</Directory>
				
				<Directory Id="DILCOMMONFILESDIR" Name="DIL">
					<Directory Id="DILCOMMONSCHEMASDIR" Name="Schemas">
						<Component Id="DILSchemasComponent" Guid="BC36206D-B106-42E0-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="DILcatalog.xml" Name="catalog.xml" src="..\XML\DIL\catalog.xml"
								DefaultLanguage="0" CompanionFile="DILSchemaCatalog.xml"/>
							<File Id="DIL.xsd" Name="DIL.xsd" src="..\XML\DIL\DIL.xsd"
								DefaultLanguage="0" CompanionFile="DILcatalog.xml"/>
							<File Id="DCIL.xsd" Name="DCIL.xsd" src="..\XML\DIL\DCIL.xsd"
								DefaultLanguage="0" CompanionFile="DIL.xsd"/>
							<File Id="DDIL.xsd" Name="DDIL.xsd" src="..\XML\DIL\DDIL.xsd"
								DefaultLanguage="0" CompanionFile="DIL.xsd"/>
							<File Id="DMIL.xsd" Name="DMIL.xsd" src="..\XML\DIL\DMIL.xsd"
								DefaultLanguage="0" CompanionFile="DIL.xsd"/>
							<File Id="DILDT.xsd" Name="DILDT.xsd" src="..\XML\DIL\DILDT.xsd"
								DefaultLanguage="0" CompanionFile="DIL.xsd"/>
							<File Id="DILEP.xsd" Name="DILEP.xsd" src="..\XML\DIL\DILEP.xsd"
								DefaultLanguage="0" CompanionFile="DIL.xsd"/>
							<File Id="DILMS.xsd" Name="DILMS.xsd" src="..\XML\DIL\DILMS.xsd"
								DefaultLanguage="0" CompanionFile="DIL.xsd"/>
						</Component>
					</Directory>
					<Directory Id="DILCOMMONTRANSFORMSDIR" Name="Trnsfrms" LongName="Transforms">
						<Component Id="DILTransformsComponent" Guid="E0653834-4F4F-426B-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<File Id="DILSupportFunctions.xslt" Name="DILSF.xsl" LongName="DILSupportFunctions.xslt" src="..\XML\DIL\DILSupportFunctions.xslt"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
							<File Id="DDILtoSQLStandard.xslt" Name="DIL2Stnd.xsl" LongName="DDILtoSQLStandard.xslt" src="..\XML\DILtoSQL\DDILtoSQLStandard.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\DDILtoSQLStandard">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="DDILtoSQLStandard"/>
								<Registry Type="string" Name="DisplayName" Value="DDIL to SQL Standard"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms DDIL to Standard-dialect SQL."/>
								<Registry Type="string" Name="FileExtension" Value=".SQLStandard.sql"/>
								<Registry Type="string" Name="SourceInputFormat" Value="DDIL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="SQL_SQLStandard"/>
								<Registry Type="string" Name="TransformUri" Value="[#DDILtoSQLStandard.xslt]"/>
							</Registry>
							<File Id="DDILtoDB2.xslt" Name="DIL2DB2.xsl" LongName="DDILtoDB2.xslt" src="..\XML\DILtoSQL\DDILtoDB2.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\DDILtoDB2">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="DDILtoDB2"/>
								<Registry Type="string" Name="DisplayName" Value="DDIL to DB2"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms DDIL to DB2-dialect SQL."/>
								<Registry Type="string" Name="FileExtension" Value=".DB2.sql"/>
								<Registry Type="string" Name="SourceInputFormat" Value="DDIL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="SQL_DB2"/>
								<Registry Type="string" Name="TransformUri" Value="[#DDILtoDB2.xslt]"/>
							</Registry>
							<File Id="DDILtoPostgreSQL.xslt" Name="DIL2Post.xsl" LongName="DDILtoPostgreSQL.xslt" src="..\XML\DILtoSQL\DDILtoPostgreSQL.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\DDILtoPostgreSQL">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="DDILtoPostgreSQL"/>
								<Registry Type="string" Name="DisplayName" Value="DDIL to PostgreSQL"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms DDIL to PostgreSQL-dialect SQL."/>
								<Registry Type="string" Name="FileExtension" Value=".PostgreSQL.sql"/>
								<Registry Type="string" Name="SourceInputFormat" Value="DDIL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="SQL_PostgreSQL"/>
								<Registry Type="string" Name="TransformUri" Value="[#DDILtoPostgreSQL.xslt]"/>
							</Registry>
							<File Id="DDILtoSQLServer.xslt" Name="DIL2MS.xsl" LongName="DDILtoSQLServer.xslt" src="..\XML\DILtoSQL\DDILtoSQLServer.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\DDILtoSQLServer">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="DDILtoSQLServer"/>
								<Registry Type="string" Name="DisplayName" Value="DDIL to SQL Server"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms DDIL to SQL Server-dialect SQL."/>
								<Registry Type="string" Name="FileExtension" Value=".SQLServer.sql"/>
								<Registry Type="string" Name="SourceInputFormat" Value="DDIL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="SQL_SQLServer"/>
								<Registry Type="string" Name="TransformUri" Value="[#DDILtoSQLServer.xslt]"/>
							</Registry>
							<File Id="DDILtoOracle.xslt" Name="DIL2Orac.xsl" LongName="DDILtoOracle.xslt" src="..\XML\DILtoSQL\DDILtoOracle.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\DDILtoOracle">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="DDILtoOracle"/>
								<Registry Type="string" Name="DisplayName" Value="DDIL to Oracle"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms DDIL to Oracle-dialect SQL."/>
								<Registry Type="string" Name="FileExtension" Value=".Oracle.sql"/>
								<Registry Type="string" Name="SourceInputFormat" Value="DDIL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="SQL_Oracle"/>
								<Registry Type="string" Name="TransformUri" Value="[#DDILtoOracle.xslt]"/>
							</Registry>
							<File Id="DomainInliner.xslt" Name="DmnInlnr.xsl" LongName="DomainInliner.xslt" src="..\XML\DILtoSQL\DomainInliner.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<File Id="DCILtoDDIL.xslt" Name="DCIL2DDL.xsl" LongName="DCILtoDDIL.xslt" src="..\XML\DILtoSQL\DCILtoDDIL.xslt"
								DefaultLanguage="0" CompanionFile="DILSupportFunctions.xslt"/>
							<Registry Action="createKeyAndRemoveKeyOnUninstall" Root="HKLM" Key="$(var.NORMARegRoot)\Generators\DCILtoDDIL">
								<Registry Type="string" Name="Type" Value="XSLT"/>
								<Registry Type="string" Name="OfficialName" Value="DCILtoDDIL"/>
								<Registry Type="string" Name="DisplayName" Value="DCIL to DDIL"/>
								<Registry Type="string" Name="DisplayDescription" Value="Transforms DCIL to DDIL."/>
								<Registry Type="string" Name="FileExtension" Value=".DDIL.xml"/>
								<Registry Type="string" Name="SourceInputFormat" Value="DCIL"/>
								<Registry Type="string" Name="ProvidesOutputFormat" Value="DDIL"/>
								<Registry Type="string" Name="TransformUri" Value="[#DCILtoDDIL.xslt]"/>
							</Registry>
						</Component>
					</Directory>
				</Directory>
				
			</Directory>

			<Directory Id="VSTEMPLATEITEMDIR">
				<Directory Id="VisualBasic" Name="VBasic" LongName="VisualBasic">
					<Component Id="NORMAVSProjectItemsVBasicComponent" Guid="5D140A94-9C4A-4B60-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
						<Condition>VBASICPACKAGEGUID OR Installed</Condition>
						<File Id="VisualBasic.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\VisualBasic.zip"
							DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
					</Component>
				</Directory>
				<Directory Id="CSharp" Name="CSharp">
					<Component Id="NORMAVSProjectItemsVCSharpComponent" Guid="C1AAAF79-FA94-45C0-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
						<Condition>VCSHARPPACKAGEGUID OR Installed</Condition>
						<File Id="CSharp.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\CSharp.zip"
							DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
					</Component>
				</Directory>
				<Directory Id="JSharp" Name="JSharp">
					<Component Id="NORMAVSProjectItemsVJSharpComponent" Guid="B6ACBD38-3FAD-4C24-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
						<Condition>VJSHARPPACKAGEGUID OR Installed</Condition>
						<File Id="JSharp.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\JSharp.zip"
							DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
					</Component>
				</Directory>
				<Directory Id="VisualC" Name="VisualC">
					<Component Id="NORMAVSProjectItemsVCPlusPlusComponent" Guid="16B28893-FE72-4BBF-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
						<Condition>VCPLUSPLUSPACKAGEGUID OR Installed</Condition>
						<File Id="VisualC.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\VisualC.zip"
							DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
					</Component>
				</Directory>
				<Directory Id="Web" Name="Web">
					<Directory Id="WebVisualBasic" Name="VBasic" LongName="VisualBasic">
						<Component Id="NORMAVSProjectItemsVWebDevVBasicComponent" Guid="4EC6EE56-3F04-4F0F-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<Condition>VWEBDEVPACKAGEGUID OR Installed</Condition>
							<File Id="WebVisualBasic.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\Web\VisualBasic.zip"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
						</Component>
					</Directory>
					<Directory Id="WebCSharp" Name="CSharp">
						<Component Id="NORMAVSProjectItemsVWebDevCSharpComponent" Guid="7E4BA3AB-3831-4520-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<Condition>VWEBDEVPACKAGEGUID OR Installed</Condition>
							<File Id="WebCSharp.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\Web\CSharp.zip"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
						</Component>
					</Directory>
					<Directory Id="WebJSharp" Name="JSharp">
						<Component Id="NORMAVSProjectItemsVWebDevJSharpComponent" Guid="E68504E4-D956-4A87-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)" KeyPath="yes">
							<Condition>VWEBDEVPACKAGEGUID OR Installed</Condition>
							<File Id="WebJSharp.zip" Name="ORMModel.zip" src="..\ORMModel\Shell\ProjectItems\Web\JSharp.zip"
								DefaultLanguage="0" CompanionFile="Neumont.Tools.ORM.dll"/>
						</Component>
					</Directory>
				</Directory>
			</Directory>
			
			<Directory Id="VSPRODUCTDIR">
				<Directory Id="VSXMLDIR" Name="Xml">
					<Directory Id="VSXMLSCHEMASDIR" Name="Schemas">
						<!-- Point Visual Studio to additional XML Schema Catalog directories. -->
						<Component Id="NORMAVSSchemaCatalogComponent" Guid="5E3279C3-FEC1-48C7-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
							<File Id="NORMASchemaCatalog.xml" Name="NORMACat.xml" LongName="NORMASchemaCatalog.xml" src="NORMASchemaCatalog.xml"
								DefaultLanguage="0" KeyPath="yes"/>
						</Component>
						<Component Id="ORMSchemaCatalogComponent" Guid="3571DCC0-D86B-4705-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
							<File Id="ORMSchemaCatalog.xml" Name="ORMCat.xml" LongName="ORMSchemaCatalog.xml" src="ORMSchemaCatalog.xml"
								DefaultLanguage="0" KeyPath="yes"/>
						</Component>
						<Component Id="DILSchemaCatalogComponent" Guid="67E1A72B-7FEE-483C-$(var.VersionGuidSuffix)" DiskId="1" Win64="$(var.Win64)">
							<File Id="DILSchemaCatalog.xml" Name="DILCat.xml" LongName="DILSchemaCatalog.xml" src="DILSchemaCatalog.xml"
								DefaultLanguage="0" KeyPath="yes"/>
						</Component>
					</Directory>
				</Directory>
			</Directory>
			
		</Directory>
	</Fragment>
</Wix>
